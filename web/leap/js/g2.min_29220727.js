var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},g2;!function(t){var e=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var r=this;r.x=t,r.y=e}return Object.defineProperty(t.prototype,"length",{get:function(){var t=this;return Math.sqrt(t.x*t.x+t.y*t.y)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"normalize",{get:function(){var e=this,r=e.length;return new t(e.x/r,e.y/r)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"normLine",{get:function(){var e=this;return new t(e.y,-e.x)},enumerable:!0,configurable:!0}),t.equals=function(t,e){return t.x==e.x&&t.y==e.y},t.distance=function(t,e){var r=t.x-e.x,n=t.y-e.y;return Math.sqrt(r*r+n*n)},t.add=function(e,r){return new t(e.x+r.x,e.y+r.y)},t.substract=function(e,r){return new t(e.x-r.x,e.y-r.y)},t.dot=function(t,e,r){void 0===r&&(r=!1);var n=r?t.normalize:t,o=r?e.normalize:e;return n.x*o.x+n.y*o.y},t.projection=function(e,r){return t.dot(e,r)/r.length},t}();t.Vector2=e,__reflect(e.prototype,"g2.Vector2")}(g2||(g2={}));var g2;!function(t){var e;!function(e){var r=function(){function e(t){this.type="Circle";var e=this;e.r=t,e.x=0,e.y=0,e.scaleX=1,e.scaleY=1,e.rotation=0}return e.prototype.getRadius=function(){var t=this;return t.r*t.scaleX},e.prototype.getProjection=function(e){var r=this,n=new t.Vector2(r.x,r.y),o=t.Vector2.projection(n,e),i=r.getRadius();return{min:o-i,max:o+i}},e}();e.Circle=r,__reflect(r.prototype,"g2.SAT.Circle",["g2.SAT.IShape"])}(e=t.SAT||(t.SAT={}))}(g2||(g2={}));var g2;!function(t){var e;!function(e){var r=function(){function e(t){this.type="Polygon";var e=this;e.originVertices=t,e.x=0,e.y=0,e.scaleX=1,e.scaleY=1,e.rotation=0}return e.prototype.getVerticesCoordinate=function(){var e=this;if(1==e.scaleX&&1==e.scaleY&&e.rotation%360==0)return e.originVertices;for(var r=[],n=e.originVertices,o=0,i=n.length;i>o;o++){var c=n[o],a=new t.Vector2;a.x=c.x*e.scaleX,a.y=c.y*e.scaleY;var s=e.rotation/180*Math.PI,u=a.x*Math.cos(s)-a.y*Math.sin(s),l=a.x*Math.sin(s)+a.y*Math.cos(s);a.x=u,a.y=l,a.x+=e.x,a.y+=e.y,r.push(a)}return r},e.prototype.getSides=function(){var e=this,r=e.getVerticesCoordinate(),n=r.length,o=[];if(n>=3){for(var i=1,c=r[0];n>i;i++){var a=r[i];o.push(t.Vector2.substract(a,c)),c=a}o.push(t.Vector2.substract(r[0],r[n-1]))}return o},e.prototype.getNearestPoint=function(e){for(var r=this,n=r.getVerticesCoordinate(),o=n[0],i=t.Vector2.distance(e,o),c=1,a=n.length;a>c;c++){var s=n[c],u=t.Vector2.distance(e,s);i>u&&(i=u,o=s)}return o},e.prototype.getProjection=function(e){for(var r,n,o=this,i=o.getVerticesCoordinate(),c=0,a=i.length;a>c;c++){var s=i[c],u=t.Vector2.projection(s,e);(!r||r>u)&&(r=u),(!n||u>n)&&(n=u)}return{min:r,max:n}},e}();e.Polygon=r,__reflect(r.prototype,"g2.SAT.Polygon",["g2.SAT.IShape"])}(e=t.SAT||(t.SAT={}))}(g2||(g2={}));var g2;!function(t){var e;!function(e){e.checkCollision=function(t,e){var n=!1;if("Polygon"==t.type&&"Polygon"==e.type)n=r.polygonsCollision(t,e);else if("Circle"==t.type&&"Circle"==e.type)n=r.circlesCollision(t,e);else{var o=void 0,i=void 0;"Circle"==t.type?(o=t,i=e):(o=e,i=t),n=r.circlePolygonCollision(o,i)}return n};var r=function(){function e(){}return e.polygonsCollision=function(t,r){for(var n=t.getSides().concat(r.getSides()),o=[],i=0,c=n.length;c>i;i++)o.push(n[i].normLine);for(var i=0,a=o.length;a>i;i++){var s=o[i],u=e.filterCal(s,o,i);if(!u){var l=t.getProjection(s),f=r.getProjection(s);if(!e.isOverlay(l,f))return!1}}return!0},e.circlesCollision=function(e,r){var n=new t.Vector2(e.x-r.x,e.y-r.y);return n.length<=e.getRadius()+r.getRadius()},e.circlePolygonCollision=function(r,n){for(var o=n.getSides(),i=[],c=0,a=o.length;a>c;c++)i.push(o[c].normLine);var s=n.getNearestPoint(new t.Vector2(r.x,r.y));i.push(new t.Vector2(s.x-r.x,s.y-r.y));for(var c=0,u=i.length;u>c;c++){var l=i[c],f=e.filterCal(l,i,c);if(!f){var g=r.getProjection(l),y=n.getProjection(l);if(!e.isOverlay(g,y))return!1}}return!0},e.isOverlay=function(t,e){var r,n;return r=t.min<e.min?t.min:e.min,n=t.max>e.max?t.max:e.max,t.max-t.min+(e.max-e.min)>n-r},e.filterCal=function(e,r,n){for(var o=!1,i=0;n>i;i++){var c=t.Vector2.dot(e,r[i],!0);if(1==Math.abs(c)){o=!0;break}}return o},e}();e.SATTest=r,__reflect(r.prototype,"g2.SAT.SATTest")}(e=t.SAT||(t.SAT={}))}(g2||(g2={}));